p8105\_hw5\_xs2330
================
Xiao Shi
November 1, 2018

Problem 1
---------

**initializing data frame and function construction**

``` r
exp_result = data_frame()

read_data = function(filepath){
  read_csv(filepath)
}
```

**Use function read\_data**

``` r
csvs = list.files("./")
exp_result = purrr::map_df(.x = csvs[1:20], read_data)
csvs = csvs[1:20] %>%
  str_replace(".csv", "")
```

First got a variable with all necessary file names, then use the function read\_data to get resulting data frame from 20 excel files. Finally, manipulate `csvs` for further use.

**tidy results**

``` r
exp_cleaned = mutate(exp_result, specimen_id = csvs) %>%
  mutate(unique_id = specimen_id) %>%
  separate(col = specimen_id, into = c("arm", "id"), sep = "_") %>%
  gather(key = week, value = score, week_1:week_8)
knitr::kable(exp_cleaned[1:6,])
```

| arm | id  | unique\_id | week    |  score|
|:----|:----|:-----------|:--------|------:|
| con | 01  | con\_01    | week\_1 |   0.20|
| con | 02  | con\_02    | week\_1 |   1.13|
| con | 03  | con\_03    | week\_1 |   1.77|
| con | 04  | con\_04    | week\_1 |   1.04|
| con | 05  | con\_05    | week\_1 |   0.47|
| con | 06  | con\_06    | week\_1 |   2.37|

**ploting experimental vs control group**

``` r
ggplot(data = exp_cleaned, mapping = aes(x = week, y = score, group = unique_id, color = arm)) +
  geom_line() +
  labs(title = "Observations in experiment and control groups over eight weeks")
```

![](p8105_hw5_xs2330_files/figure-markdown_github/unnamed-chunk-4-1.png)

From the colored spagatti plot, we see a higher score distribution in the experimental group, and lower score distribution in the control group. Also, we observe that both groups started at approximately the same level. However, as we approach week\_8, everyone in the experimental group has a hight score than everyone in the control group. Since the experiment is randomized, there is no need to distinguish within-group score differences, thus all subjects in the same arm are assigned the same color.

Problem 2
---------

**create city\_state**

``` r
raw_homicide = read_csv("./homicide-data.csv") 
```

    ## Parsed with column specification:
    ## cols(
    ##   uid = col_character(),
    ##   reported_date = col_integer(),
    ##   victim_last = col_character(),
    ##   victim_first = col_character(),
    ##   victim_race = col_character(),
    ##   victim_age = col_character(),
    ##   victim_sex = col_character(),
    ##   city = col_character(),
    ##   state = col_character(),
    ##   lat = col_double(),
    ##   lon = col_double(),
    ##   disposition = col_character()
    ## )

``` r
homicide = raw_homicide %>%
  mutate(city_state = str_c(city, state, sep = ", ")) %>%
  janitor::clean_names()
```

The raw homicide dataset consists of case information (uid, reported\_date, disposition), geo information (city, state, lat, lon), and victim information (race, age, first and last name) of homocidal crimes on 50 large U.S. cities. The data is consist of 52179 rows by 13 columns.
